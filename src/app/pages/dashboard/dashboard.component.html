<div class="dashboard-container">
  
  <header class="mb-8">
    <h2 class="text-3xl font-bold text-gray-800">Resumen Financiero</h2>
    <p class="text-gray-500">Vista general de tus movimientos y métricas</p>
  </header>

  <div class="kpi-grid mb-8">
    <div class="kpi-card income">
      <div class="icon-wrapper">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 19.5v-15m0 0l-6.75 6.75M12 4.5l6.75 6.75" />
        </svg>          
      </div>
      <div class="kpi-info">
        <span class="label">Ingresos Totales</span>
        <span class="value text-green-600">+${{ sumas?.ingreso | number:'1.2-2' }}</span>
      </div>
    </div>

    <div class="kpi-card expense">
      <div class="icon-wrapper">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m0 0l6.75-6.75M12 19.5l-6.75-6.75" />
        </svg>
      </div>
      <div class="kpi-info">
        <span class="label">Egresos Totales</span>
        <span class="value text-red-600">-${{ sumas?.egreso | number:'1.2-2' }}</span>
      </div>
    </div>

    <div class="kpi-card balance">
      <div class="icon-wrapper">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3" />
        </svg>
      </div>
      <div class="kpi-info">
        <span class="label">Balance Actual</span>
        <span class="value text-gray-800">${{ (sumas?.ingreso - sumas?.egreso) | number:'1.2-2' }}</span>
      </div>
    </div>
  </div>

  <div class="main-grid mb-8">
    
    <div class="card chart-section">
      <div class="card-header">
        <h3 class="text-lg font-bold text-gray-700">Gasto Mensual Estimado</h3>
      </div>
      <div class="chart-wrapper">
        <bar-chart [data]="datosGrafica"></bar-chart>
      </div>
    </div>

    <div class="card table-section">
      <div class="card-header">
        <h3 class="text-lg font-bold text-gray-700">Relación Mensual</h3>
      </div>
      <div class="overflow-x-auto">
        <table class="w-full text-sm text-left text-gray-500">
          <thead class="text-xs text-gray-700 uppercase bg-gray-50 sticky top-0">
            <tr>
              <th scope="col" class="px-4 py-3">Mes</th>
              <th scope="col" class="px-4 py-3 text-right">Ingreso</th>
              <th scope="col" class="px-4 py-3 text-right">Egreso</th>
              <th scope="col" class="px-4 py-3 text-right">Balance</th>
            </tr>
          </thead>
          <tbody>
            @for (item of tablaMensual; track $index) {
              <tr class="border-b hover:bg-gray-50 transition-colors">
                <td class="px-4 py-3 font-medium text-gray-900">{{ item.mes }}</td>
                <td class="px-4 py-3 text-right text-green-600 font-semibold">+{{ item.ingreso | number }}</td>
                <td class="px-4 py-3 text-right text-red-500 font-semibold">-{{ item.egreso | number }}</td>
                <td class="px-4 py-3 text-right font-bold" 
                    [class.text-green-600]="item.balance >= 0" 
                    [class.text-red-600]="item.balance < 0">
                  {{ item.balance | number }}
                </td>
              </tr>
            } @empty {
              <tr><td colspan="4" class="px-4 py-8 text-center text-gray-400">Sin datos registrados</td></tr>
            }
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="card w-full">
    <div class="card-header border-b border-gray-100 pb-4 mb-4">
      <h3 class="text-lg font-bold text-gray-700">Últimos Movimientos</h3>
    </div>
    <ui-table style="width: 100%;" (clicktabla)="click($event)" (verDetalle)="verDetalleDialog($event)" [data]="data"></ui-table>
  </div>

</div>